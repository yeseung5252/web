<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATEGORY</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2207-02@1.0/LeeSeoyun.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
 <a href="index.html" class="home-button" title="í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°">
    ğŸ 
</a>
    <div class="page-content">
        <h1>CATEGORY</h1>

        <nav class="tab-menu">
            <a href="#" class="tab-item active" data-category="all">ì „ì²´</a>
            <a href="#" class="tab-item" data-category="diary">ë‹¤ì´ì–´ë¦¬</a>
            <a href="#" class="tab-item" data-category="sticker">ìŠ¤í‹°ì»¤</a>
            <a href="#" class="tab-item" data-category="tape">ë§ˆìŠ¤í‚¹í…Œì´í”„</a>
            <a href="#" class="tab-item" data-category="binder">ë°”ì¸ë”</a>
            <a href="#" class="tab-item" data-category="cover">ì»¤ë²„</a>
            <a href="#" class="tab-item" data-category="kisscut">í‚¤ìŠ¤ì»·</a>
            <a href="#" class="tab-item" data-category="modoji">ëª¨ì¡°ì§€</a>
        </nav>

        <div class="product-list-container" id="product-list-container">
            </div>
    </div>

    <script>
        // ---------------------------------------------
        // 1. ìƒí’ˆ ë°ì´í„° ì •ì˜ (ë¶ë§ˆí¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ IDëŠ” ê³ ìœ í•´ì•¼ í•¨)
        // ---------------------------------------------
        const products = [
            { id: 1, name: "í˜¸ë³´ë‹ˆì¹˜ í…Œìµ¸ ë‹¤ì´ì–´ë¦¬", category: "diary", price: 45400, img: "prod-1.jpg", link:"https://smartstore.naver.com/_bestpen/products/12338987905?nl-query=%ED%98%B8%EB%B3%B4%EB%8B%88%EC%B9%98+2026&nl-ts-pid=jgw0VlqX6IdssfVc9f0-420469&NaPm=ct%3Dmj30v9r4%7Cci%3D7a4ddc04d76cc5a9dbcc00c9b3c5eaebb274ff25%7Ctr%3Dimg%7Csn%3D457624%7Chk%3D7bd37faf06f06779dcbcc41570addf0d41ae28f1" },
            { id: 2, name: "í•‘ë£¨ ë”¸ê¸°ì´ˆì½” ìŠ¤í‹°ì»¤íŒ©", category: "sticker", price: 8000, img: "prod-2.jpg", link:"http://www.10x10.co.kr/shopping/category_prd.asp?itemid=6779971" },
            { id: 3, name: "ì–´ë²„ë¸”í¬ëŸ¬ì‰¬ A7 6ê³µ ë°”ì¸ë”", category: "binder", price: 20000, img: "prod-3.jpg", link:"https://smartstore.naver.com/sosorowa/products/11877022826" },
            { id: 4, name: "ë„ë¡±ìƒì  ìŒí‘œ ì ¤ë¦¬ MT", category: "tape", price: 4000, img: "prod-4.jpg", link:"https://smartstore.naver.com/dorong_ham/products/10490896026" },
            { id: 5, name: "ì§€êµ¬ì¹¨ëµ ì´ˆì½”ë°”ë‚˜ë‚˜ ëª¨ì¡°ì§€", category: "modoji", price: 3000, img: "prod-5.jpg", link:"https://smartstore.naver.com/chuplay/products/11549780555" },
            { id: 6, name: "ì œí‚¤ë² ì–´ íŒ¨í„´ë³„ í‚¤ìŠ¤ì»·", category: "kisscut", price: 6000, img: "prod-6.jpg", link:"https://smartstore.naver.com/helloplay/products/11958162205" },
            { id: 7, name: "í˜ì´ì ¬ ë‹¤ì´ì–´ë¦¬", category: "diary", price: 21900, img: "prod-7.jpg", link:"https://www.coupang.com/vp/products/8405289397?itemId=24299267108&vendorItemId=91315257515&src=1032001&spec=10305199&addtag=400&ctag=8405289397&lptag=I24299267108&itime=20251213002925&pageType=PRODUCT&pageValue=8405289397&wPcid=17552633397573116103713&wRef=cr.shopping.naver.com&wTime=20251213002925&redirect=landing&mcid=b92706fd02d14de3a9117b355a300936&n_keyword=&n_ad_group=&n_ad=&n_ad=&n_rank=&n_keyword_id=&n_media=&n_campaign_type=&n_query=" },
            { id: 8, name: "B6 ë‹¤ì´ì–´ë¦¬ PVC ì»¤ë²„", category: "cover", price: 1500, img: "prod-8.jpg", link:"http://www.10x10.co.kr/shopping/category_prd.asp?itemid=6438417" },
            { id: 9, name: "ë„ë¯¸ì›”ë“œ ë¬´ê´‘ì¹¼ì„ ìŠ¤í‹°ì»¤", category: "sticker", price: 5500, img: "prod-9.jpg", link:"https://smartstore.naver.com/dudumoon/products/7624754781?nl-query=%EB%8F%84%EB%AF%B8%EC%9B%94%EB%93%9C+%EC%8A%A4%ED%8B%B0%EC%BB%A4&nl-ts-pid=jgw3EwqX6IdssfVb32C-357965&NaPm=ct%3Dmj31ba54%7Cci%3Ddfa20f8029496a7d24323f318ce0888025c992fd%7Ctr%3Dimg%7Csn%3D931564%7Chk%3Ddf1cf010bb96fff77bcb986361b5eb31d1fbb2cb" },
        ];

        const tabs = document.querySelectorAll('.tab-item');
        const productContainer = document.getElementById('product-list-container');
        
        // ---------------------------------------------
        // 2. HTML êµ¬ì¡° ìƒì„± í•¨ìˆ˜
        // ---------------------------------------------
        function createProductHtml(product) {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            const isBookmarked = bookmarks.includes(product.id);
            const heartIcon = isBookmarked ? 'â™¥' : 'â™¡';
            const heartClass = isBookmarked ? 'bookmarked' : '';

            return `
                <a href="${product.link}" target="_blank" class="product-link">
                    <div class="product-item">
                        <img src="${product.img}" alt="${product.name}">
                        <h3>${product.name}</h3>
                        <p class="price">${product.price.toLocaleString()}ì›</p>
                        
                        <span class="bookmark-icon ${heartClass}" data-product-id="${product.id}">
                            ${heartIcon}
                        </span>
                    </div>
                </a>
            `;
        }

        // ---------------------------------------------
        // 3. ë¶ë§ˆí¬ ë¦¬ìŠ¤ë„ˆ ì—°ê²° í•¨ìˆ˜
        // ---------------------------------------------
        function attachBookmarkListeners() {
            document.querySelectorAll('.bookmark-icon').forEach(icon => {
                icon.addEventListener('click', (e) => {
                    e.preventDefault();   
                    e.stopPropagation();  
                    
                    const productId = parseInt(icon.dataset.productId);
                    let bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');

                    if (icon.classList.contains('bookmarked')) {
                        // ë¶ë§ˆí¬ ì œê±°
                        bookmarks = bookmarks.filter(id => id !== productId);
                        icon.classList.remove('bookmarked');
                        icon.textContent = 'â™¡';
                    } else {
                        // ë¶ë§ˆí¬ ì¶”ê°€
                        bookmarks.push(productId);
                        icon.classList.add('bookmarked');
                        icon.textContent = 'â™¥';
                    }

                    localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
                });
            });
        }
        
        // ---------------------------------------------
        // 4. ìƒí’ˆ ëª©ë¡ ë Œë”ë§ ë° í•„í„°ë§ ë¡œì§ (ê²€ìƒ‰ì–´ ì²˜ë¦¬ ë¡œì§ ê°•í™”)
        // ---------------------------------------------
        function renderProducts(filterCategory, searchQuery = null) {
            let filteredProducts = products;

            // â­ï¸ ì¹´í…Œê³ ë¦¬ í•œêµ­ì–´ ë§¤í•‘ í…Œì´ë¸” (ê²€ìƒ‰ì–´ ë¹„êµì— ì‚¬ìš©)
            const categoryMap = {
                'diary': 'ë‹¤ì´ì–´ë¦¬',
                'cover': 'ì»¤ë²„',
                'binder': 'ë°”ì¸ë”',
                'sticker': 'ìŠ¤í‹°ì»¤',
                'tape': 'ë§ˆìŠ¤í‚¹í…Œì´í”„',
                'kisscut': 'í‚¤ìŠ¤ì»·',
                'modoji': 'ëª¨ì¡°ì§€'
            };
            
            // 1. ì¹´í…Œê³ ë¦¬ í•„í„°ë§ (íƒ­ í´ë¦­ ì‹œ)
            if (filterCategory && filterCategory !== 'all') {
                filteredProducts = filteredProducts.filter(product => 
                    product.category.includes(filterCategory)
                );
            }
            
            // 2. ê²€ìƒ‰ì–´ í•„í„°ë§ (ê²€ìƒ‰ì–´ê°€ ìˆì„ ê²½ìš°)
            if (searchQuery) {
                const query = searchQuery.toLowerCase();
                filteredProducts = filteredProducts.filter(product => {
                    
                    // â­ï¸ ìƒí’ˆ ì´ë¦„ (í•œê¸€)ì— ê²€ìƒ‰ì–´ê°€ í¬í•¨ë˜ëŠ”ì§€ í™•ì¸
                    const nameMatch = product.name.toLowerCase().includes(query);
                    
                    // â­ï¸ ì¹´í…Œê³ ë¦¬ í•œê¸€ ì´ë¦„ì— ê²€ìƒ‰ì–´ê°€ í¬í•¨ë˜ëŠ”ì§€ í™•ì¸
                    const categoryKoreanName = categoryMap[product.category] || '';
                    const categoryMatch = categoryKoreanName.toLowerCase().includes(query);
                    
                    // ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ë©´ í‘œì‹œ
                    return nameMatch || categoryMatch;
                });
            }
            
            // 3. ê²°ê³¼ í‘œì‹œ
            if (filteredProducts.length === 0) {
                productContainer.innerHTML = `<p style="text-align: center; margin-top: 50px;">
                                                ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                                            </p>`;
            } else {
                const productHtml = filteredProducts.map(createProductHtml).join('');
                productContainer.innerHTML = productHtml;
            }

            attachBookmarkListeners(); 
        }

        // ---------------------------------------------
        // 5. íƒ­ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        // ---------------------------------------------
        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                tabs.forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
                const selectedCategory = e.target.dataset.category;
                
                // íƒ­ í´ë¦­ ì‹œì—ëŠ” ê²€ìƒ‰ì–´ ì—†ì´ ì¹´í…Œê³ ë¦¬ë§Œ í•„í„°ë§
                renderProducts(selectedCategory, null); 
                
                // íƒ€ì´í‹€ ì´ˆê¸°í™”
                document.querySelector('.page-content h1').textContent = 'CATEGORY';
            });
        });

        // ---------------------------------------------
        // 6. í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” ë¡œì§ (URL ê²€ìƒ‰ì–´ ì²˜ë¦¬)
        // ---------------------------------------------
        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const searchQuery = urlParams.get('search');
            
            if (searchQuery) {
                // ê²€ìƒ‰ì–´ê°€ ìˆìœ¼ë©´
                tabs.forEach(t => t.classList.remove('active'));
                document.querySelector('.tab-item[data-category="all"]').classList.add('active');
                
                // ë””ì½”ë”©ëœ ê²€ìƒ‰ì–´ë¥¼ ì‚¬ìš©í•´ ìƒí’ˆ ë Œë”ë§
                const decodedQuery = decodeURIComponent(searchQuery);
                renderProducts('all', decodedQuery);
                
                // ì‚¬ìš©ìì—ê²Œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ í‘œì‹œ
                const title = document.querySelector('.page-content h1');
                title.textContent = `CATEGORY - "${decodedQuery}" ê²€ìƒ‰ ê²°ê³¼`;
                
            } else {
                // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ 'ì „ì²´' íƒ­ í´ë¦­ìœ¼ë¡œ ëª¨ë“  ìƒí’ˆ í‘œì‹œ
                document.querySelector('.tab-item[data-category="all"]').click(); 
            }
        };
    </script>
</body>
</html>